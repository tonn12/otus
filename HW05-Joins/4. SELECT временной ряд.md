1. Среднее время в пути по дням
SELECT
    date_trunc('day', (data -> 'flight' ->> 'departure')::timestamp) AS day,
    avg(
        (data -> 'flight' ->> 'arrival')::timestamp -
        (data -> 'flight' ->> 'departure')::timestamp
    ) AS avg_flight_time
FROM tickets_jsonb
GROUP BY day
ORDER BY day;

2. Максимальная дальность перелёта по неделям
SELECT
    date_trunc('week', (data -> 'flight' ->> 'departure')::timestamp) AS week,
    max((data -> 'flight' ->> 'range_km')::int) AS max_range_km
FROM tickets_jsonb
GROUP BY week
ORDER BY week;